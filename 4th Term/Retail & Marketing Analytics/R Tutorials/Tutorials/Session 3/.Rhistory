lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt-Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
day_list = seq(1, 14, by=1)
df <- data.frame(day_list,ARIMA, Holt.Winters)
df
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
day_list = seq(1, 14, by=1)
df <- data.frame(day_list,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing ARIMA and Holt Winters")
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
day_list = seq(1, 14, by=1)
df <- data.frame(day_list,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing ARIMA and Holt Winters Model")
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
day_list = seq(1, 14, by=1)
df <- data.frame(day_list,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
knitr::kable(lettuce_demand_4904.training.ets1.f, caption = "2 Week Prediction for Store 4904")
autoplot(lettuce_demand_4904.training.ets1.f)
accuracy_4904_final <- as.data.frame(x=rbind(accuracy_m1,accuracy_ets1), row.names = c("M1 Training Dataset", "M1 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
knitr::kable(accuracy_4904_final, caption = "Accuracy of Best ARIMA and Holt-Winter Models")
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
lettuce_demand_4904.training.ets2 <- ets(lettuce_demand_4904.training , model = "ZZZ")
lettuce_demand_4904.training.ets2
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
plot(lettuce_demand_4904.training.m1.f)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
plot(lettuce_demand_4904.training.m1.f)
lines(fitted(lettuce_demand_4904.training.m1.f), col = "blue")
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
data <- read.csv(file = "lettuce_demand_4904.csv", header = TRUE)
lettuce_demand_12631 <- ts(data[, 4], frequency = 7)
lettuce_demand_12631.training = window(lettuce_demand_12631, end = c(12,4))
lettuce_demand_12631.testing = window(lettuce_demand_12631, start = c(12,5))
lettuce_demand_12631
ggtsdisplay(lettuce_demand_4904.training)
boxplot(lettuce_demand_4904.training ~ cycle(lettuce_demand_4904.training))
ggtsdisplay(lettuce_demand_12631.training)
boxplot(lettuce_demand_12631.training ~ cycle(lettuce_demand_12631.training))
adf_4904_training <- adf.test(lettuce_demand_4904)
pp_4904_training <- pp.test(lettuce_demand_4904)
kpss_4904_training <- kpss.test(lettuce_demand_4904)
test_results_4904 <- data.frame(Test=c("ADF", "PP", "KPSS"),
"P Value" =c(adf_4904_training$p.value,pp_4904_training$p.value,kpss_4904_training$p.value))
knitr::kable(test_results_4904, caption = "Tests for the non-seasonal part of training dataset")
adf_12631_training <- adf.test(lettuce_demand_12631)
pp_12631_training <- pp.test(lettuce_demand_12631)
kpss_12631_training <- kpss.test(lettuce_demand_12631)
test_results_12631 <- data.frame(Test=c("ADF", "PP", "KPSS"),
"P Value" =c(adf_12631_training$p.value,pp_12631_training$p.value,kpss_12631_training$p.value))
knitr::kable(test_results_12631, caption = "Tests for the non-seasonal part of training dataset")
ndiffs_12631_training <- ndiffs(lettuce_demand_12631)
nsdiffs_12631_training <- nsdiffs(lettuce_demand_12631)
differencing_12631 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_12631_training,nsdiffs_12631_training))
knitr::kable(differencing_12631, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
ndiffs_12631_training <- ndiffs(lettuce_demand_12631)
nsdiffs_12631_training <- nsdiffs(lettuce_demand_12631)
differencing_12631 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_12631_training,nsdiffs_12631_training))
knitr::kable(differencing_12631, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
ndiffs_12631_training <- ndiffs(lettuce_demand_12631)
nsdiffs_12631_training <- nsdiffs(lettuce_demand_12631)
differencing_12631 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_12631_training,nsdiffs_12631_training))
knitr::kable(differencing_12631, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
ndiffs_12631_training <- ndiffs(lettuce_demand_12631)
nsdiffs_12631_training <- nsdiffs(lettuce_demand_12631)
differencing_12631 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_12631_training,nsdiffs_12631_training))
knitr::kable(differencing_12631, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
lettuce_demand_4904.training.diff = diff(lettuce_demand_4904.training,differences = 1, lag = 7)
autoplot(lettuce_demand_4904.training.diff)
boxplot(lettuce_demand_4904.training.diff ~ cycle(lettuce_demand_4904.training.diff))
lettuce_demand_12631.training.diff = diff(lettuce_demand_12631.training,differences = 1, lag = 7)
autoplot(lettuce_demand_12631.training.diff)
boxplot(lettuce_demand_12631.training.diff ~ cycle(lettuce_demand_12631.training.diff))
auto.arima(lettuce_demand_12631.training, trace = TRUE, ic = 'bic')
auto.arima(lettuce_demand_12631.training, trace = TRUE, ic = 'bic')
data <- read.csv(file = "lettuce_demand_12631.csv", header = TRUE)
lettuce_demand_12631 <- ts(data[, 4], frequency = 7)
lettuce_demand_12631.training = window(lettuce_demand_12631, end = c(12,4))
lettuce_demand_12631.testing = window(lettuce_demand_12631, start = c(12,5))
lettuce_demand_12631
lettuce_demand_12631.testing
data <- read.csv(file = "lettuce_demand_12631.csv", header = TRUE)
lettuce_demand_12631 <- ts(data[, 4], frequency = 7)
lettuce_demand_12631.training = window(lettuce_demand_12631, end = c(12,4))
lettuce_demand_12631.testing = window(lettuce_demand_12631, start = c(13,1))
lettuce_demand_12631
lettuce_demand_12631.testing
data <- read.csv(file = "lettuce_demand_12631.csv", header = TRUE)
lettuce_demand_12631 <- ts(data[, 4], frequency = 7)
lettuce_demand_12631.training = window(lettuce_demand_12631, end = c(12,4))
lettuce_demand_12631.testing = window(lettuce_demand_12631, start = c(13,6))
lettuce_demand_12631
lettuce_demand_12631.testing
data <- read.csv(file = "lettuce_demand_12631.csv", header = TRUE)
lettuce_demand_12631 <- ts(data[, 4], frequency = 7)
lettuce_demand_12631.training = window(lettuce_demand_12631, end = c(13,5))
lettuce_demand_12631.testing = window(lettuce_demand_12631, start = c(13,6))
lettuce_demand_12631
ggtsdisplay(lettuce_demand_12631.training)
boxplot(lettuce_demand_12631.training ~ cycle(lettuce_demand_12631.training))
ndiffs_12631_training <- ndiffs(lettuce_demand_12631)
nsdiffs_12631_training <- nsdiffs(lettuce_demand_12631)
differencing_12631 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_12631_training,nsdiffs_12631_training))
knitr::kable(differencing_12631, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
ggtsdisplay(lettuce_demand_12631.training)
boxplot(lettuce_demand_12631.training ~ cycle(lettuce_demand_12631.training))
ndiffs_12631_training <- ndiffs(lettuce_demand_12631)
nsdiffs_12631_training <- nsdiffs(lettuce_demand_12631)
differencing_12631 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_12631_training,nsdiffs_12631_training))
knitr::kable(differencing_12631, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
lettuce_demand_12631.training.diff = diff(lettuce_demand_12631.training,differences = 1, lag = 7)
autoplot(lettuce_demand_12631.training.diff)
boxplot(lettuce_demand_12631.training.diff ~ cycle(lettuce_demand_12631.training.diff))
auto.arima(lettuce_demand_12631.training, trace = TRUE, ic = 'bic')
# Best Model: ARIMA(0,1,1)(2,0,0)[7] (922.2888)
# Second Best Model: ARIMA(0,1,1)(1,0,0)[7]  (922.9761)
best_model_12631 <- data.frame('Ranks'=c("Best Model", "Second Best Model","Third Best Model"),
'Models' = c("ARIMA(0,1,1)(2,0,0)[7]","ARIMA(0,1,1)(1,0,0)[7]"),
"BIC" =c(922.2888,922.9761))
# Best Model: ARIMA(0,1,1)(2,0,0)[7] (922.2888)
# Second Best Model: ARIMA(0,1,1)(1,0,0)[7]  (922.9761)
best_model_12631 <- data.frame('Ranks'=c("Best Model", "Second Best Model"),
'Models' = c("ARIMA(0,1,1)(2,0,0)[7]","ARIMA(0,1,1)(1,0,0)[7]"),
"BIC" =c(922.2888,922.9761))
knitr::kable(best_model_12631, caption = "The Best Two ARIMA Models for Store 4904")
lettuce_demand_12631.training.m1 <- Arima(lettuce_demand_12631.training, order = c(0, 1, 1),seasonal = list(order = c(2, 0, 0), period = 7),include.drift = FALSE)
lettuce_demand_12631.training.m2 <- Arima(lettuce_demand_12631.training, order = c(0, 1, 1),seasonal = list(order = c(1, 0, 0), period = 7),include.drift = FALSE)
lettuce_demand_12631.training.m3 <- Arima(lettuce_demand_12631.training, order = c(0, 1, 1),seasonal = list(order = c(2, 1, 0), period = 7),include.drift = FALSE)
lettuce_demand_12631.training.m1.f <- forecast(lettuce_demand_12631.training.m1, h = 14)
lettuce_demand_12631.training.m2.f <- forecast(lettuce_demand_12631.training.m2, h = 14)
lettuce_demand_12631.training.m3.f <- forecast(lettuce_demand_12631.training.m3, h = 14)
accuracy_12631_m1 = accuracy(lettuce_demand_12631.training.m1.f,lettuce_demand_12631.testing)
accuracy_12631_m2 = accuracy(lettuce_demand_12631.training.m2.f,lettuce_demand_12631.testing)
accuracy_12631_m3 = accuracy(lettuce_demand_12631.training.m3.f,lettuce_demand_12631.testing)
accuracy_12631_arima <- as.data.frame(x=rbind(accuracy_12631_m1, accuracy_12631_m2, accuracy_12631_m3), row.names = c("M1 Training Dataset", "M1 Testing Dataset", "M2 Training Dataset", "M2 Testing Dataset", "M3 Training Dataset", "M3 Testing Dataset"))
knitr::kable(accuracy_accuracy_12631_m3_arima, caption = "Accuracy of The Three Best ARIMA Models")
lettuce_demand_12631.training.m1.f <- forecast(lettuce_demand_12631.training.m1, h = 14)
lettuce_demand_12631.training.m2.f <- forecast(lettuce_demand_12631.training.m2, h = 14)
lettuce_demand_12631.training.m3.f <- forecast(lettuce_demand_12631.training.m3, h = 14)
accuracy_12631_m1 = accuracy(lettuce_demand_12631.training.m1.f,lettuce_demand_12631.testing)
accuracy_12631_m2 = accuracy(lettuce_demand_12631.training.m2.f,lettuce_demand_12631.testing)
accuracy_12631_m3 = accuracy(lettuce_demand_12631.training.m3.f,lettuce_demand_12631.testing)
accuracy_12631_arima <- as.data.frame(x=rbind(accuracy_12631_m1, accuracy_12631_m2, accuracy_12631_m3), row.names = c("M1 Training Dataset", "M1 Testing Dataset", "M2 Training Dataset", "M2 Testing Dataset", "M3 Training Dataset", "M3 Testing Dataset"))
knitr::kable(accuracy_12631_arima, caption = "Accuracy of The Three Best ARIMA Models")
lettuce_demand_12631.training.ets2 <- ets(lettuce_demand_12631.training , model = "ZZZ")
lettuce_demand_12631.training.ets2
lettuce_demand_12631.training.ets1.f <- forecast(lettuce_demand_12631.training.ets1, h = 14)
lettuce_demand_12631.training.ets1.f <- forecast(lettuce_demand_12631.training.ets1, h = 14)
lettuce_demand_12631.training.ets1 <- ets(lettuce_demand_12631.training , model = "ZZZ")
lettuce_demand_12631.training.ets1
lettuce_demand_12631.training.ets1.f <- forecast(lettuce_demand_12631.training.ets1, h = 14)
accuracy_12631_ets1 <- accuracy(lettuce_demand_12631.training.ets1.f,lettuce_demand_12631.testing)
accuracy_12631_ets.df <- as.data.frame(x=rbind(accuracy_12631_ets1), row.names = c("ETS1 Training Dataset","ETS2 Testing Dataset"))
knitr::kable(accuracy_4904_ets.df, caption = "Accuracy of The Best Holt-Winters Model")
lettuce_demand_12631.training.ets1.f <- forecast(lettuce_demand_12631.training.ets1, h = 14)
accuracy_12631_ets1 <- accuracy(lettuce_demand_12631.training.ets1.f,lettuce_demand_12631.testing)
accuracy_12631_ets.df <- as.data.frame(x=rbind(accuracy_12631_ets1), row.names = c("ETS1 Training Dataset","ETS2 Testing Dataset"))
knitr::kable(accuracy_12631_ets.df, caption = "Accuracy of The Best Holt-Winters Model")
lettuce_demand_12631.training.m1.f.df <- as.data.frame(lettuce_demand_12631.training.m1.f)
ARIMA <- lettuce_demand_12631.training.m1.f.df$'Point Forecast'
lettuce_demand_12631.training.ets1.f.df <- as.data.frame(lettuce_demand_12631.training.ets1.f)
Holt.Winters <- lettuce_demand_12631.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
accuracy_12631_final <- as.data.frame(x=rbind(accuracy_m1,accuracy_ets1), row.names = c("M1 Training Dataset", "M1 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
knitr::kable(accuracy_12631_final, caption = "Accuracy of Best ARIMA and Holt-Winter Models")
accuracy_12631_final <- as.data.frame(x=rbind(accuracy_12631_m3,accuracy_12631_ets1), row.names = c("M3 Training Dataset", "M3 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
knitr::kable(accuracy_12631_final, caption = "Accuracy of Best ARIMA and Holt-Winter Models")
knitr::kable(lettuce_demand_12631.training.m3.f, caption = "2 Week Prediction for Store 4904")
autoplot(lettuce_demand_12631.training.m3.f)
data <- read.csv(file = "lettuce_demand_20974.csv", header = TRUE)
lettuce_demand_20974 <- ts(data[, 4], frequency = 7)
lettuce_demand_20974.training = window(lettuce_demand_20974, end = c(13,5))
lettuce_demand_20974.testing = window(lettuce_demand_20974, start = c(13,6))
data <- read.csv(file = "lettuce_demand_20974.csv", header = TRUE)
lettuce_demand_20974 <- ts(data[, 4], frequency = 7)
lettuce_demand_20974.training = window(lettuce_demand_20974, end = c(13,5))
# lettuce_demand_20974.testing = window(lettuce_demand_20974, start = c(13,6))
lettuce_demand_20974
data <- read.csv(file = "lettuce_demand_20974.csv", header = TRUE)
lettuce_demand_20974 <- ts(data[, 4], frequency = 7)
lettuce_demand_20974.training = window(lettuce_demand_20974, end = c(11,5))
lettuce_demand_20974.testing = window(lettuce_demand_20974, start = c(11,6))
lettuce_demand_20974.testing
data <- read.csv(file = "lettuce_demand_20974.csv", header = TRUE)
lettuce_demand_20974 <- ts(data[, 4], frequency = 7)
lettuce_demand_20974.training = window(lettuce_demand_20974, end = c(11,5))
lettuce_demand_20974.testing = window(lettuce_demand_20974, start = c(11,6))
lettuce_demand_20974.testing
data <- read.csv(file = "lettuce_demand_20974.csv", header = TRUE)
lettuce_demand_20974 <- ts(data[, 4], frequency = 7)
lettuce_demand_20974.training = window(lettuce_demand_20974, end = c(11,4))
lettuce_demand_20974.testing = window(lettuce_demand_20974, start = c(11,5))
lettuce_demand_20974.testing
ggtsdisplay(lettuce_demand_20974.training)
boxplot(lettuce_demand_20974.training ~ cycle(lettuce_demand_20974.training))
ggtsdisplay(lettuce_demand_20974.training)
boxplot(lettuce_demand_20974.training ~ cycle(lettuce_demand_20974.training))
ndiffs_12631_training <- ndiffs(lettuce_demand_12631)
nsdiffs_12631_training <- nsdiffs(lettuce_demand_12631)
differencing_12631 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_12631_training,nsdiffs_12631_training))
knitr::kable(differencing_12631, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
ndiffs_4904_training <- ndiffs(lettuce_demand_4904)
nsdiffs_4904_training <- nsdiffs(lettuce_demand_4904)
differencing_4904 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_4904_training,nsdiffs_4904_training))
knitr::kable(differencing_4904, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
ndiffs_20974_training <- ndiffs(lettuce_demand_20974)
nsdiffs_20974_training <- nsdiffs(lettuce_demand_20974)
differencing_20974 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_20974_training,nsdiffs_20974_training))
knitr::kable(differencing_20974, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
auto.arima(lettuce_demand_12631.training, trace = TRUE, ic = 'bic')
auto.arima(lettuce_demand_20974.training, trace = TRUE, ic = 'bic')
lettuce_demand_20974.training.m1.f <- forecast(lettuce_demand_20974.training.m1, h = 14)
# Best Model: ARIMA(0,0,1)(1,0,0)[7] with non-zero mean (778.9095)
# Second Best Model:ARIMA(1,0,0)(1,0,0)[7] with non-zero mean (779.0975)
best_model_20974 <- data.frame('Ranks'=c("Best Model", "Second Best Model"),
'Models' = c("ARIMA(0,0,1)(1,0,0)[7]","ARIMA(1,0,0)(1,0,0)[7]"),
"BIC" =c(778.9095,779.0975))
knitr::kable(best_model_20974, caption = "The Best Two ARIMA Models for Store 4904")
lettuce_demand_20974.training.m1 <- Arima(lettuce_demand_20974.training, order = c(0, 0, 1),seasonal = list(order = c(1, 0, 0), period = 7),include.drift = FALSE)
lettuce_demand_20974.training.m2 <- Arima(lettuce_demand_20974.training, order = c(1, 0, 0),seasonal = list(order = c(1, 0, 0), period = 7),include.drift = FALSE)
lettuce_demand_20974.training.m3 <- Arima(lettuce_demand_20974.training, order = c(0, 0, 1),seasonal = list(order = c(1, 1, 0), period = 7),include.drift = FALSE)
lettuce_demand_20974.training.m1.f <- forecast(lettuce_demand_20974.training.m1, h = 14)
lettuce_demand_20974.training.m2.f <- forecast(lettuce_demand_20974.training.m2, h = 14)
lettuce_demand_20974.training.m3.f <- forecast(lettuce_demand_20974.training.m3, h = 14)
accuracy_20974_m1 = accuracy(lettuce_demand_20974.training.m1.f,lettuce_demand_20974.testing)
accuracy_20974_m2 = accuracy(lettuce_demand_20974.training.m2.f,lettuce_demand_20974.testing)
accuracy_20974_m3 = accuracy(lettuce_demand_20974.training.m3.f,lettuce_demand_20974.testing)
accuracy_20974_arima <- as.data.frame(x=rbind(accuracy_20974_m1, accuracy_20974_m2, accuracy_20974_m3), row.names = c("M1 Training Dataset", "M1 Testing Dataset", "M2 Training Dataset", "M2 Testing Dataset", "M3 Training Dataset", "M3 Testing Dataset"))
knitr::kable(accuracy_20974_arima, caption = "Accuracy of The Three Best ARIMA Models")
lettuce_demand_20974.training.ets1 <- ets(lettuce_demand_20974.training , model = "ZZZ")
lettuce_demand_20974.training.ets1
lettuce_demand_ETS(A,N,A) .training.ets1.f <- forecast(lettuce_demand_20974.training.ets1, h = 14)
lettuce_demand_20974.training.ets1.f <- forecast(lettuce_demand_20974.training.ets1, h = 14)
accuracy_20974_ets1 <- accuracy(lettuce_demand_20974.training.ets1.f,lettuce_demand_20974.testing)
accuracy_20974_ets.df <- as.data.frame(x=rbind(accuracy_20974_ets1), row.names = c("ETS1 Training Dataset","ETS2 Testing Dataset"))
knitr::kable(accuracy_20974_ets.df, caption = "Accuracy of The Best Holt-Winters Model")
lettuce_demand_20974.training.m1.f.df <- as.data.frame(lettuce_demand_20974.training.m1.f)
ARIMA <- lettuce_demand_20974.training.m1.f.df$'Point Forecast'
lettuce_demand_20974.training.ets1.f.df <- as.data.frame(lettuce_demand_20974.training.ets1.f)
Holt.Winters <- lettuce_demand_20974.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
accuracy_20974_final <- as.data.frame(x=rbind(accuracy_20974_m3,accuracy_20974_ets1), row.names = c("M3 Training Dataset", "M3 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
knitr::kable(accuracy_20974_final, caption = "Accuracy of Best ARIMA and Holt-Winter Models")
lettuce_demand_20974.training.m1.f.df <- as.data.frame(lettuce_demand_20974.training.m1.f)
ARIMA <- lettuce_demand_20974.training.m1.f.df$'Point Forecast'
lettuce_demand_20974.training.ets1.f.df <- as.data.frame(lettuce_demand_20974.training.ets1.f)
Holt.Winters <- lettuce_demand_20974.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
accuracy_20974_final <- as.data.frame(x=rbind(accuracy_20974_m1,accuracy_20974_ets1), row.names = c("M1 Training Dataset", "M1 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
knitr::kable(accuracy_20974_final, caption = "Accuracy of Best ARIMA and Holt-Winter Models")
knitr::kable(lettuce_demand_20974.training.m1.f, caption = "2 Week Prediction for Store 20974")
autoplot(lettuce_demand_20974.training.m1.f)
data <- read.csv(file = "lettuce_demand_46673.csv", header = TRUE)
lettuce_demand_46673 <- ts(data[, 4], frequency = 7)
lettuce_demand_46673.training = window(lettuce_demand_46673, end = c(11,4))
lettuce_demand_46673.testing = window(lettuce_demand_46673, start = c(11,5))
lettuce_demand_46673.testing
data <- read.csv(file = "lettuce_demand_46673.csv", header = TRUE)
lettuce_demand_46673 <- ts(data[, 4], frequency = 7)
lettuce_demand_46673.training = window(lettuce_demand_46673, end = c(13,4))
lettuce_demand_46673.testing = window(lettuce_demand_46673, start = c(13,5))
lettuce_demand_46673.testing
data <- read.csv(file = "lettuce_demand_46673.csv", header = TRUE)
lettuce_demand_46673 <- ts(data[, 4], frequency = 7)
lettuce_demand_46673.training = window(lettuce_demand_46673, end = c(13,3))
lettuce_demand_46673.testing = window(lettuce_demand_46673, start = c(13,4))
lettuce_demand_46673.testing
data <- read.csv(file = "lettuce_demand_46673.csv", header = TRUE)
lettuce_demand_46673 <- ts(data[, 4], frequency = 7)
lettuce_demand_46673.training = window(lettuce_demand_46673, end = c(13,5))
lettuce_demand_46673.testing = window(lettuce_demand_46673, start = c(13,6))
lettuce_demand_46673.testing
data <- read.csv(file = "lettuce_demand_46673.csv", header = TRUE)
lettuce_demand_46673 <- ts(data[, 4], frequency = 7)
lettuce_demand_46673.training = window(lettuce_demand_46673, end = c(13,5))
lettuce_demand_46673.testing = window(lettuce_demand_46673, start = c(13,6))
ggtsdisplay(lettuce_demand_46673.training)
boxplot(lettuce_demand_46673.training ~ cycle(lettuce_demand_46673.training))
ndiffs_46673_training <- ndiffs(lettuce_demand_46673)
nsdiffs_46673_training <- nsdiffs(lettuce_demand_46673)
differencing_46673 <- data.frame(Test=c("ndiffs", "nsdiffs"),
"P Value" =c(ndiffs_46673_training,nsdiffs_46673_training))
knitr::kable(differencing_46673, caption = "Differencing for the non-seasonal and seasonal part of training dataset")
auto.arima(lettuce_demand_46673.training, trace = TRUE, ic = 'bic')
# Best Model: ARIMA(0,0,0)(0,1,1)[7]  (781.1482)
# Second Best Model: ARIMA(0,0,1)(0,1,1)[7] (782.7104)
# Second Best Model: ARIMA(1,0,0)(0,1,1)[7] (782.8503)
best_model_46673 <- data.frame('Ranks'=c("Best Model", "Second Best Model", "Third Best Model"),
'Models' = c("ARIMA(0,0,0)(0,1,1)[7]","ARIMA(0,0,1)(0,1,1)[7]","ARIMA(1,0,0)(0,1,1)[7]"),
"BIC" =c(781.1482,782.7104,782.8503))
knitr::kable(best_model_46673, caption = "The Best Three ARIMA Models for Store 46673")
lettuce_demand_46673.training.m1 <- Arima(lettuce_demand_46673.training, order = c(0, 0, 0),seasonal = list(order = c(0, 1, 1), period = 7),include.drift = FALSE)
lettuce_demand_46673.training.m2 <- Arima(lettuce_demand_46673.training, order = c(0, 0, 1),seasonal = list(order = c(0, 1, 1), period = 7),include.drift = FALSE)
lettuce_demand_46673.training.m3 <- Arima(lettuce_demand_46673.training, order = c(1, 0, 0),seasonal = list(order = c(0, 1, 1), period = 7),include.drift = FALSE)
lettuce_demand_46673.training.m1.f <- forecast(lettuce_demand_46673.training.m1, h = 14)
lettuce_demand_46673.training.m2.f <- forecast(lettuce_demand_46673.training.m2, h = 14)
lettuce_demand_46673.training.m3.f <- forecast(lettuce_demand_46673.training.m3, h = 14)
accuracy_46673_m1 = accuracy(lettuce_demand_46673.training.m1.f,lettuce_demand_46673.testing)
accuracy_46673_m2 = accuracy(lettuce_demand_46673.training.m2.f,lettuce_demand_46673.testing)
accuracy_46673_m3 = accuracy(lettuce_demand_46673.training.m3.f,lettuce_demand_46673.testing)
accuracy_46673_arima <- as.data.frame(x=rbind(accuracy_46673_m1, accuracy_46673_m2, accuracy_46673_m3), row.names = c("M1 Training Dataset", "M1 Testing Dataset", "M2 Training Dataset", "M2 Testing Dataset", "M3 Training Dataset", "M3 Testing Dataset"))
knitr::kable(accuracy_46673_arima, caption = "Accuracy of The Three Best ARIMA Models")
lettuce_demand_46673.training.ets1 <- ets(lettuce_demand_46673.training , model = "ZZZ")
lettuce_demand_46673.training.ets1
lettuce_demand_46673.training.ets1.f <- forecast(lettuce_demand_46673.training.ets1, h = 14)
accuracy_46673_ets1 <- accuracy(lettuce_demand_46673.training.ets1.f,lettuce_demand_46673.testing)
accuracy_46673_ets.df <- as.data.frame(x=rbind(accuracy_46673_ets1), row.names = c("ETS1 Training Dataset","ETS2 Testing Dataset"))
knitr::kable(accuracy_46673_ets.df, caption = "Accuracy of The Best Holt-Winters Model")
lettuce_demand_46673.training.m3.f.df <- as.data.frame(lettuce_demand_46673.training.m3.f)
ARIMA <- lettuce_demand_46673.training.m3.f.df$'Point Forecast'
lettuce_demand_46673.training.ets1.f.df <- as.data.frame(lettuce_demand_46673.training.ets1.f)
Holt.Winters <- lettuce_demand_46673.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
accuracy_46673_final <- as.data.frame(x=rbind(accuracy_46673_m3,accuracy_46673_ets1), row.names = c("M3 Training Dataset", "M3 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
knitr::kable(accuracy_46673_final, caption = "Accuracy of Best ARIMA and Holt-Winter Models")
accuracy_46673_final <- as.data.frame(x=rbind(accuracy_46673_m3,accuracy_46673_ets1), row.names = c("M3 Training Dataset", "M3 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
knitr::kable(accuracy_46673_final, caption = "Accuracy of Best ARIMA and Holt-Winter Models")
knitr::kable(lettuce_demand_46673.training.m3.f, caption = "2 Week Prediction for Store 46673")
autoplot(lettuce_demand_46673.training.m1.f)
accuracy_46673_final <- as.data.frame(x=rbind(accuracy_46673_m3,accuracy_46673_ets1), row.names = c("M3 Training Dataset", "M3 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
knitr::kable(accuracy_46673_final, caption = "Accuracy of Best ARIMA and Holt-Winter Models")
lettuce_demand_46673.training.m3.f.df <- as.data.frame(lettuce_demand_46673.training.m3.f)
ARIMA <- lettuce_demand_46673.training.m3.f.df$'Point Forecast'
lettuce_demand_46673.training.ets1.f.df <- as.data.frame(lettuce_demand_46673.training.ets1.f)
Holt.Winters <- lettuce_demand_46673.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
checkresiduals(lettuce_demand_4904.training.m1)
knitr::opts_chunk$set(echo = TRUE)
library(forecast)
library(tseries)
library(ggplot2)
data <- read.csv(file = "lettuce_demand_4904.csv", header = TRUE)
lettuce_demand_4904 <- ts(data[, 4], frequency = 7)
lettuce_demand_4904.training = window(lettuce_demand_4904, end = c(12,4))
lettuce_demand_4904.testing = window(lettuce_demand_4904, start = c(12,5))
lettuce_demand_4904
ggtsdisplay(lettuce_demand_4904.training)
boxplot(lettuce_demand_4904.training ~ cycle(lettuce_demand_4904.training))
adf_4904_training <- adf.test(lettuce_demand_4904)
pp_4904_training <- pp.test(lettuce_demand_4904)
kpss_4904_training <- kpss.test(lettuce_demand_4904)
test_results_4904 <- data.frame(Test=c("ADF", "PP", "KPSS"),
"P Value" =c(adf_4904_training$p.value,pp_4904_training$p.value,kpss_4904_training$p.value))
knitr::kable(test_results_4904, caption = "Tests for the non-seasonal part of training dataset")
lettuce_demand_4904.training.diff = diff(lettuce_demand_4904.training,differences = 1, lag = 7)
autoplot(lettuce_demand_4904.training.diff)
boxplot(lettuce_demand_4904.training.diff ~ cycle(lettuce_demand_4904.training.diff))
# Best Model: ARIMA(0,0,0)(2,1,0)[7]  (814.8431)
# Second Best Model: ARIMA(1,0,1)(2,1,0)[7]  (815.9494)
# Third Best Model: ARIMA(0,0,0)(1,1,0)[7]  (816.4742)
best_model_4904 <- data.frame('Ranks'=c("Best Model", "Second Best Model","Third Best Model"),
'Models' = c("ARIMA(0,0,0)(2,1,0)[7]","ARIMA(1,0,1)(2,1,0)[7]","ARIMA(0,0,0)(1,1,0)[7]"),
"BIC" =c(814.8431,815.9494,816.4742))
knitr::kable(best_model_4904, caption = "The Best Three ARIMA Models for Store 4904")
lettuce_demand_4904.training.m1 <- Arima(lettuce_demand_4904.training, order = c(0, 0, 0),seasonal = list(order = c(2, 1, 0), period = 7),include.drift = FALSE)
lettuce_demand_4904.training.m2 <- Arima(lettuce_demand_4904.training, order = c(1, 0, 1),seasonal = list(order = c(2, 1, 0), period = 7),include.drift = FALSE)
lettuce_demand_4904.training.m3 <- Arima(lettuce_demand_4904.training, order = c(0, 0, 0),seasonal = list(order = c(1, 1, 0), period = 7),include.drift = FALSE)
checkresiduals(lettuce_demand_4904.training.m1)
checkresiduals(lettuce_demand_4904.training.m2)
checkresiduals(lettuce_demand_4904.training.m3)
checkresiduals(lettuce_demand_4904.training.m)
checkresiduals(lettuce_demand_4904.training.m2)
lettuce_demand_4904.training.m1.f <- forecast(lettuce_demand_4904.training.m1, h = 14)
lettuce_demand_4904.training.m2.f <- forecast(lettuce_demand_4904.training.m2, h = 14)
lettuce_demand_4904.training.m3.f <- forecast(lettuce_demand_4904.training.m3, h = 14)
accuracy_m1 = accuracy(lettuce_demand_4904.training.m1.f,lettuce_demand_4904.testing)
accuracy_m2 = accuracy(lettuce_demand_4904.training.m2.f,lettuce_demand_4904.testing)
accuracy_m3 = accuracy(lettuce_demand_4904.training.m3.f,lettuce_demand_4904.testing)
accuracy_4904_arima <- as.data.frame(x=rbind(accuracy_m1, accuracy_m2, accuracy_m3), row.names = c("M1 Training Dataset", "M1 Testing Dataset", "M2 Training Dataset", "M2 Testing Dataset", "M3 Training Dataset", "M3 Testing Dataset"))
knitr::kable(accuracy_4904_arima, caption = "Accuracy of The Three Best ARIMA Models")
checkresiduals(lettuce_demand_4904.training.m2)
accuracy_4904_final <- as.data.frame(x=rbind(accuracy_m2,accuracy_ets1), row.names = c("M2 Training Dataset", "M2 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
lettuce_demand_4904.training %>% stl(s.window = "period") %>% autoplot
lettuce_demand_4904.training.ets1 <- ets(lettuce_demand_4904.training , model = "ANA")
lettuce_demand_4904.training.ets2 <- ets(lettuce_demand_4904.training , model = "ZZZ")
lettuce_demand_4904.training.ets2
lettuce_demand_4904.training.ets1.f <- forecast(lettuce_demand_4904.training.ets1, h = 14)
accuracy_ets1 <- accuracy(lettuce_demand_4904.training.ets1.f,lettuce_demand_4904.testing)
accuracy_4904_ets <- as.data.frame(x=rbind(accuracy_ets1), row.names = c("ETS1 Training Dataset","ETS2 Testing Dataset"))
knitr::kable(accuracy_4904_ets, caption = "Accuracy of The Best Holt-Winters Model")
lettuce_demand_4904.training.m1.f.df <- as.data.frame(lettuce_demand_4904.training.m1.f)
ARIMA <- lettuce_demand_4904.training.m1.f.df$'Point Forecast'
lettuce_demand_4904.training.ets1.f.df <- as.data.frame(lettuce_demand_4904.training.ets1.f)
Holt.Winters <- lettuce_demand_4904.training.ets1.f.df$'Point Forecast'
Days = seq(1, 14, by=1)
df <- data.frame(Days,ARIMA, Holt.Winters)
knitr::kable(df, caption = "Comparing the result of ARIMA and Holt Winters Model")
accuracy_4904_final <- as.data.frame(x=rbind(accuracy_m2,accuracy_ets1), row.names = c("M2 Training Dataset", "M2 Testing Dataset","ets1 Training Dataset","ets2 Testing Dataset"))
knitr::kable(accuracy_4904_final, caption = "Accuracy of Best ARIMA and Holt-Winter Models")
# if you are using Windows, you might try to install the following packages if you are not able to proceed:
#install.packages("installr",repos = "http://cran.us.r-project.org")
#install.rtools()
#install.pandoc()
install.packages("forecast", repos = "http://cran.us.r-project.org")
install.packages("stargazer", repos = "http://cran.us.r-project.org")
install.packages("tseries", repos = "http://cran.us.r-project.org")
install.packages("knitr", repos = "http://cran.us.r-project.org")
install.packages("readxl", repos = "http://cran.us.r-project.org")
install.packages("knitr", repos = "http://cran.us.r-project.org")
install.packages("knitr", repos = "http://cran.us.r-project.org")
install.packages("knitr", repos = "http://cran.us.r-project.org")
install.packages("knitr", repos = "http://cran.us.r-project.org")
install.packages("knitr", repos = "http://cran.us.r-project.org")
install.packages("forecast", repos = "http://cran.us.r-project.org")
install.packages("stargazer", repos = "http://cran.us.r-project.org")
install.packages("tseries", repos = "http://cran.us.r-project.org")
install.packages("knitr", repos = "http://cran.us.r-project.org")
install.packages("readxl", repos = "http://cran.us.r-project.org")
install.packages("vars", repos = "http://cran.us.r-project.org")
library(knitr)
library(knitr)
library(readxl)
library(forecast)
library(knitr)
library(readxl)
library(forecast)
library(tseries)
library(vars)
library(stargazer)
# Please run the following codes depending on the operating system on your laptop/PC.
# if you are using iOS, and your *resource_allocation* folder is created under "Downloads" on your Mac: you will need to first set your working directory to *resource_allocation* folder:
# if you are using Windows, and your *resource_allocation* folder is created in your H drive: you will need to first set your working directory to *resource_allocation* folder:
#setwd("H:/downloads/resource_allocation")
# load the datasets
data <- read_excel("~/Dataset/resource.xlsx")
# Please run the following codes depending on the operating system on your laptop/PC.
# if you are using iOS, and your *resource_allocation* folder is created under "Downloads" on your Mac: you will need to first set your working directory to *resource_allocation* folder:
# if you are using Windows, and your *resource_allocation* folder is created in your H drive: you will need to first set your working directory to *resource_allocation* folder:
#setwd("H:/downloads/resource_allocation")
# load the datasets
data <- read_excel("Dataset/resource.xlsx")
head(data)
ts.plot(data$Sales, col="blue", main="Sales")
ts.plot(data$Adwords, col="darkgreen", main="Adwords")
ts.plot(data$Flyer, col="red", main="Flyers")
data$LSales <- log(data$Sales+1)
data$LAd <- log(data$Adwords+1)
data$LFlyer <- log(data$Flyer+1)
data
LSales <- ts(data$LSales, frequency = 4, start = c(1, 1))
LAd <- ts(data$LAd, frequency = 4, start = c(1, 1))
LFLYER <- ts(data$LFlyer, frequency = 4, start = c(1, 1))
adf.test(LSales)
adf.test(LAd)
adf.test(LFLYER)
LSales
adf.test(data$LSales)
